---
title: "Runtime Configuration"
metaTitle: "Configuring DeepSparse's runtime via YAML files"
metaDescription: "Configuring DeepSparse's runtime via YAML files"
index: 6000
---

# Configuring DeepSparse's Runtime

This page explains how to configure the low-level optimizations DeepSparse's inference runtime. 

DeepSparse has sensible defaults for the configuration options desribed below, but power
users may want to use this pathway to tune performance.

## Usage

The configuration file should be named `deepsparse-config.yaml`, with the following YAML:

```yaml
thread_pinning: "core"
default_precision: "bf16"
kernel_sparsity_threshold: 0.9
logging_level: "all"
```

By default, the runtime looks for the `deepsparse-config.yaml` file in the `.config/neuralmagic` directory. If
the file exists, the runtime will parse the file and use the provided options. If not, the runtime falls back to the defaults.

The config directory can be overriden using the `NM_CONFIG_DIR` enviornment variable. In this case, the runtime will look for `NM_CONFIG_DIR/deepsparse-config.yaml`.

## Options

**`thread_pinning`** enables binding of threads to cores or sockets.

Valid Options are the following:
- `core` - binds thread to an individual core
- `numa` - binds thread to cores within a numa node
- `socket` - binds thread to cores within a socket
- `none` - no thread pinning

[XXX] - ***Can you add 1-2 brief sentences on when you might want to try a each option?***

The default option is determined by heuristics depending on the scheduler and other options like batch splitting.


**`default_precision`** sets the precision of the floating point numbers in the runtime, enabling
users to choose between 32-bit Floats, 16-bit Floats, and 16-bit B-Floats.

Valid options are the following:
- `fp32` - sets default precision to 32-bit floats (i.e. no loss of precision).
- `fp16` - sets default precision to 16-bit floats. This saves on memory and 
- `bf16` - sets defaul precision to 16-bit floats. 

[XXX] - ***Can we add a 2 sentence description of BF16. Just comment at a high level on what it is and approximately what speedup is able to be achieved***

The default precision is `fp32`.


**`kernel_sparsity_threshold`** defines the threshold at which the runtime switches between
using sparse or dense versions of each operator. If the percentage of 0's in a weight matrix
is above the provided threshold, the sparse operators will be used.

Valid options are floats between `0` and `1.0`.

The runtime uses heuristics on sparsity, architecture, size of operation, and others to 
determine the default sparsity threshold.



**`logging_level`** defines the verbosity of the logs that are printed by the runtime.

Valid options, in decreasing verbosity, are `diagnose`, `warn`, `error`, `fatal`, and `off`. 

The default is `warn`.